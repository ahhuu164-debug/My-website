<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Salamia Deliveo - اطلب من مطاعم سلمية</title>
  <!-- خطوط Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <!-- Font Awesome للأيقونات -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* أساسيات الصفحة - نظام ألوان متكامل */
    :root {
      --primary-orange: #FF6B35;
      --secondary-yellow: #FFC857;
      --accent-red: #E83F3F;
      --dark-blue: #2C3E50;
      --light-gray: #ECF0F1;
      --medium-gray: #BDC3C7;
      --white: #FFFFFF;
      --black: #2D3436;
      --success: #27AE60;
      --warning: #F39C12;
      
      --shadow-sm: 0 2px 8px rgba(0,0,0,0.1);
      --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
      --shadow-lg: 0 8px 24px rgba(0,0,0,0.15);
      
      --border-radius: 16px;
      --border-radius-lg: 24px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Cairo', sans-serif;
      background-color: var(--white);
      color: var(--black);
      line-height: 1.6;
      padding-bottom: 70px;
      overflow-x: hidden;
    }

    /* الخلفية المائية */
    .watermark-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("https://i.postimg.cc/SKYvRztj/Logo.png");
      background-repeat: repeat;
      background-size: 200px 200px;
      opacity: 0.02;
      z-index: -1;
      pointer-events: none;
    }

    /* الهيدر الثابت - الإصلاح النهائي للاهتزاز */
    .sticky-header {
      position: sticky;
      top: 0;
      z-index: 1000;
      background: linear-gradient(135deg, var(--primary-orange), var(--secondary-yellow));
      padding: 30px 0;
      box-shadow: var(--shadow-md);
      transition: padding 0.3s ease;
      backface-visibility: hidden;
      transform: translateZ(0);
      -webkit-transform: translateZ(0);
    }

    .sticky-header.scrolled {
      padding: 15px 0;
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      position: relative;
    }

    .logo-container {
      text-align: center;
    }

    .logo-container img {
      height: 80px;
      width: auto;
      transition: height 0.3s ease;
    }

    .sticky-header.scrolled .logo-container img {
      height: 60px;
    }

    /* زر التواصل - الإصلاح النهائي للاهتزاز */
    .contact-link {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      background: var(--secondary-yellow);
      color: var(--dark-blue);
      padding: 10px 18px;
      border-radius: 20px;
      text-decoration: none;
      font-weight: 600;
      font-size: 14px;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      backface-visibility: hidden;
      cursor: pointer;
      border: none;
      font-family: inherit;
    }

    .contact-link:hover {
      background: var(--white);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    /* باقي الـ CSS يبقى كما هو بدون تغيير */
    /* ... (كل الـ CSS السابق يبقى نفسه) ... */

  </style>
</head>
<body>

  <!-- الخلفية المائية -->
  <div class="watermark-bg"></div>

  <!-- الهيدر الثابت - الإصلاح النهائي للاهتزاز -->
  <header class="sticky-header" id="stickyHeader">
    <div class="header-content">
      <!-- تم تغيير الرابط المباشر إلى زر مع معالج JavaScript -->
      <button class="contact-link" id="whatsappButton">
        <i class="fas fa-phone"></i> تواصل معنا
      </button>
      <div class="logo-container">
        <img src="https://i.postimg.cc/SKYvRztj/Logo.png" alt="Salamia Deliveo">
      </div>
    </div>
  </header>

  <!-- باقي المحتوى يبقى كما هو -->
  <!-- ... (كل الـ HTML السابق يبقى نفسه) ... -->

  <script>
    // =============================================
    // نظام حماية رابط الواتساب - الإصدار المحسن
    // =============================================

    // طريقة 1: تخزين الرقم مشفر بطريقة بسيطة
    const encryptedPhone = {
      part1: '963',       // رمز الدولة
      part2: 'XXX',       // الجزء الأول من الرقم
      part3: 'XXX',       // الجزء الثاني من الرقم 
      part4: 'XXX'        // الجزء الثالث من الرقم
    };

    // طريقة 2: تجميع الرقم من أجزاء مشفرة
    function getWhatsAppNumber() {
      // هنا يمكنك وضع الرقم الحقيقي بعد إزالة XXX
      // مثال: 
      // part2: '123',
      // part3: '456',
      // part4: '789'
      return encryptedPhone.part1 + encryptedPhone.part2 + encryptedPhone.part3 + encryptedPhone.part4;
    }

    // طريقة 3: فك التشفير البسيط (يمكنك جعله أكثر تعقيداً)
    function decryptPhoneNumber() {
      const realNumber = getWhatsAppNumber();
      // إذا كان الرقم لا يزال يحتوي على XXX، استخدم الرقم الافتراضي
      if (realNumber.includes('XXX')) {
        return '963XXXXXXXXX'; // ضع رقمك الحقيقي هنا
      }
      return realNumber;
    }

    // طريقة 4: التحقق من صحة الرقم قبل الإرسال
    function validatePhoneNumber(phone) {
      const phoneRegex = /^963\d{9}$/; // يتأكد أن الرقم سوري ويحتوي 9 أرقام بعد 963
      return phoneRegex.test(phone);
    }

    // طريقة 5: إنشاء رابط الواتساب آمن
    function createSecureWhatsAppLink(message = '') {
      const phoneNumber = decryptPhoneNumber();
      
      // التحقق من صحة الرقم
      if (!validatePhoneNumber(phoneNumber)) {
        console.error('رقم الواتساب غير صحيح');
        return '#';
      }

      // تنظيف الرسالة من الأحرف الخطرة
      const cleanMessage = encodeURIComponent(message);
      
      // إنشاء الرابط
      return `https://wa.me/${phoneNumber}?text=${cleanMessage}`;
    }

    // طريقة 6: فتح الواتساب مع التحقق
    function openSecureWhatsApp(message = '') {
      const whatsappUrl = createSecureWhatsAppLink(message);
      
      if (whatsappUrl !== '#') {
        // فتح في نافذة جديدة
        window.open(whatsappUrl, '_blank', 'noopener,noreferrer');
        
        // تسجيل الحدث (يمكنك إضافة تحليلات هنا)
        console.log('تم فتح الواتساب بنجاح للرقم:', decryptPhoneNumber());
      } else {
        // في حالة الخطأ، عرض رسالة للمستخدم
        alert('عذراً، حدث خطأ في نظام التواصل. يرجى المحاولة لاحقاً.');
      }
    }

    // =============================================
    // تفعيل النظام عند تحميل الصفحة
    // =============================================

    document.addEventListener('DOMContentLoaded', function() {
      // زر التواصل في الهيدر
      const whatsappButton = document.getElementById('whatsappButton');
      if (whatsappButton) {
        whatsappButton.addEventListener('click', function() {
          openSecureWhatsApp('مرحباً، أريد الاستفسار عن خدمات التوصيل');
        });
      }

      // يمكنك إضافة أزرار واتساب أخرى بنفس الطريقة
      // مثال: زر طلب في صفحة المطعم
      function setupWhatsAppOrderButton(buttonId, restaurantName, orderDetails) {
        const button = document.getElementById(buttonId);
        if (button) {
          button.addEventListener('click', function() {
            const message = `طلب من ${restaurantName}: ${orderDetails}`;
            openSecureWhatsApp(message);
          });
        }
      }

      // =============================================
      // نظام الحماية الإضافي
      // =============================================

      // منع فتح أدوات المطور (حماية إضافية)
      document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        return false;
      });

      // منع اختصارات لوحة المفاتيح لأدوات المطور
      document.addEventListener('keydown', function(e) {
        // F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
        if (e.key === 'F12' || 
           (e.ctrlKey && e.shiftKey && e.key === 'I') ||
           (e.ctrlKey && e.shiftKey && e.key === 'J') ||
           (e.ctrlKey && e.key === 'u')) {
          e.preventDefault();
          return false;
        }
      });

      // إخفاء المتغيرات من الكونسول
      setTimeout(function() {
        if (typeof encryptedPhone !== 'undefined') {
          encryptedPhone.part2 = '***';
          encryptedPhone.part3 = '***';
          encryptedPhone.part4 = '***';
        }
      }, 5000);
    });

    // =============================================
    // الكود الأصلي للصفحة (بقي كما هو)
    // =============================================

    // إصلاح الاهتزاز في الهيدر
    window.addEventListener('scroll', function() {
      const header = document.getElementById('stickyHeader');
      
      if (window.scrollY > 100) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    });

    // بيانات البحث المحدثة مع روابط صحيحة
    const searchData = [
      { 
        name: "بيتزا سلمية", 
        type: "مطعم", 
        category: "بيتزا", 
        icon: "fas fa-pizza-slice",
        url: "restaurant-pizza-salamia.html",
        highlightItem: null
      },
      // ... (باقي البيانات تبقى كما هي)
    ];

    // عناصر البحث
    const searchInput = document.querySelector('.search-input');
    const searchBtn = document.querySelector('.search-btn');
    const searchResults = document.getElementById('searchResults');

    // عرض نتائج البحث
    function showSearchResults(query) {
      // ... (الكود الأصلي يبقى كما هو)
    }

    // إجراء البحث - الإصدار المحسن
    function performSearch(query, url, highlightItem) {
      // ... (الكود الأصلي يبقى كما هو)
    }

    // إخفاء نتائج البحث عند النقر خارجها
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.search-container')) {
        searchResults.style.display = 'none';
      }
    });

    // إضافة مستمعي الأحداث
    searchInput.addEventListener('input', function() {
      showSearchResults(this.value);
    });

    searchBtn.addEventListener('click', function() {
      const query = searchInput.value;
      if (query.trim()) {
        const filteredResults = searchData.filter(item => 
          item.name.includes(query) || item.category.includes(query)
        );
        
        if (filteredResults.length > 0) {
          const firstResult = filteredResults[0];
          performSearch(query, firstResult.url, firstResult.highlightItem);
        } else {
          window.location.href = `restaurants.html?search=${encodeURIComponent(query)}`;
        }
      } else {
        window.location.href = 'restaurants.html';
      }
    });

    // تحسين البحث بالضغط على Enter
    searchInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        searchBtn.click();
      }
    });

    // تفعيل زر CTA
    document.querySelector('.cta-button').addEventListener('click', function() {
      window.location.href = 'restaurants.html';
    });

    // تفعيل أزرار عرض المطعم
    document.querySelectorAll('.view-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const restaurantName = this.closest('.restaurant-card').querySelector('.restaurant-name').textContent;
        const restaurant = searchData.find(item => 
          item.name === restaurantName && item.type === "مطعم"
        );
        
        if (restaurant) {
          window.location.href = restaurant.url;
        } else {
          window.location.href = 'restaurants.html';
        }
      });
    });

  </script>
</body>
</html>